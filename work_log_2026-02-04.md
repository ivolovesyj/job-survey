# 작업 로그 - 2026-02-04 (Claude Desktop 연계용)

## 개요
**목표**: depth_twos 필터링에서 워딩이 다르지만 의미가 같은 직무들이 탈락하지 않도록 개선

## 완료된 작업

### 1. 직무 동의어 매핑 테이블 추가
파일: `web/app/api/jobs/route.ts`

```typescript
const JOB_TYPE_SYNONYMS: Record<string, string[]> = {
  // 개발 분야
  '프론트엔드': ['웹개발', '웹퍼블리싱', '퍼블리셔', 'UI개발', 'HTML/CSS', 'React', 'Vue', 'Angular', 'JavaScript', 'TypeScript'],
  '백엔드': ['서버개발', 'API개발', '서버사이드', 'Node.js', 'Spring', 'Django', 'Java', 'Python', 'Go'],
  '풀스택': ['프론트엔드', '백엔드', '웹개발', '서버개발', 'Full-Stack'],
  '웹개발': ['프론트엔드', '백엔드', '풀스택', '웹퍼블리싱'],
  '서버개발': ['백엔드', 'API개발', '서버사이드', '인프라'],
  '모바일': ['iOS', 'Android', '앱개발', '모바일앱', 'React Native', 'Flutter', 'Swift', 'Kotlin'],
  'iOS': ['모바일', '앱개발', 'Swift', 'Objective-C'],
  'Android': ['모바일', '앱개발', 'Kotlin', 'Java'],
  'AI/ML': ['머신러닝', '딥러닝', '인공지능', 'AI', 'ML', '데이터사이언스', 'NLP', 'CV'],
  '머신러닝': ['AI/ML', '딥러닝', '인공지능', 'AI', 'ML', '데이터사이언스'],
  '데이터': ['데이터분석', '데이터엔지니어', 'BI', 'SQL', '빅데이터', '데이터사이언스', 'ETL'],
  '데이터분석': ['데이터', 'BI', 'SQL', '빅데이터', '데이터사이언티스트'],
  'DevOps': ['인프라', 'SRE', '클라우드', 'AWS', 'GCP', 'Azure', '시스템엔지니어', 'CI/CD', 'Kubernetes'],
  '클라우드': ['DevOps', 'AWS', 'GCP', 'Azure', '인프라'],
  '보안': ['정보보안', '보안엔지니어', '시큐리티', 'Security', '보안개발'],
  'QA': ['테스트', '품질관리', 'QA엔지니어', '자동화테스트', 'SDET'],
  '게임': ['게임개발', '게임프로그래머', 'Unity', 'Unreal', '게임클라이언트', '게임서버'],
  '임베디드': ['펌웨어', '하드웨어', 'IoT', '시스템프로그래밍', 'C/C++'],
  // 비개발 분야
  '디자인': ['UI/UX', 'UIUX', 'UX디자인', 'UI디자인', '프로덕트디자인', '그래픽디자인', '시각디자인'],
  'UI/UX': ['디자인', 'UX디자인', 'UI디자인', '프로덕트디자인', '서비스디자인'],
  '기획': ['PM', 'PO', '프로덕트매니저', '서비스기획', '전략기획', '프로젝트매니저'],
  'PM': ['기획', 'PO', '프로덕트매니저', '프로젝트매니저'],
  'PO': ['기획', 'PM', '프로덕트오너', '프로덕트매니저'],
  '마케팅': ['퍼포먼스마케팅', '콘텐츠마케팅', '그로스', '브랜드마케팅', 'SNS마케팅', '디지털마케팅'],
  '영업': ['세일즈', 'Sales', 'BD', '사업개발', '비즈니스개발'],
  'HR': ['인사', '채용', '인사담당', 'HRBP', '조직문화'],
  '재무': ['회계', '경리', 'Finance', 'CFO', '재무회계'],
}
```

### 2. 의미적 매칭 함수 추가

```typescript
function checkSemanticMatch(userPref: string, jobTypes: string[]): number {
  const prefLower = userPref.toLowerCase()
  const synonyms = JOB_TYPE_SYNONYMS[userPref] || []
  const synonymsLower = synonyms.map(s => s.toLowerCase())

  for (const jobType of jobTypes) {
    const jobTypeLower = jobType.toLowerCase()

    // 1. 정방향 동의어 매칭
    if (synonymsLower.some(syn => 
      jobTypeLower.includes(syn) || syn.includes(jobTypeLower)
    )) {
      return 1
    }

    // 2. 역방향 매칭
    for (const [key, values] of Object.entries(JOB_TYPE_SYNONYMS)) {
      const keyLower = key.toLowerCase()
      const valuesLower = values.map(v => v.toLowerCase())

      if ((jobTypeLower.includes(keyLower) || keyLower.includes(jobTypeLower)) &&
          valuesLower.some(v => prefLower.includes(v) || v.includes(prefLower))) {
        return 2
      }
    }
  }

  return 0
}
```

### 3. scoreJob 함수에 2.5단계 매칭 추가

```typescript
// 2.5단계: 동의어/관련어 매칭 (의미적 연관성 - 8점)
const semanticMatchScore = checkSemanticMatch(prefType, jobDepthTwos)
if (semanticMatchScore > 0) {
  score += 8
  reasons.push(`✓ ${prefType} (연관)`)
  jobMatched = true
  break
}
```

## 매칭 우선순위

| 단계 | 매칭 유형 | 점수 |
|------|----------|------|
| 1단계 | depth_twos 정확 매칭 | 15점 |
| 2단계 | jobText(본문) 매칭 | 10점 |
| **2.5단계** | **동의어 매칭** | **8점** |
| 3단계 | Jaro-Winkler 유사도 | 12점 |
| 4단계 | depth_ones(대분류) | 5점 |

## 검증 결과
- ✅ TypeScript 컴파일 성공

## 다음 단계 (필요시)
1. 개발 서버에서 실제 테스트
   - 온보딩에서 "프론트엔드" 선택
   - "웹개발" depth_twos를 가진 공고가 나오는지 확인
2. 매핑 테이블 확장 (필요한 직무 추가)

---
*Antigravity에서 작성됨 - Claude Desktop에서 이어서 작업 가능*

## 추가 수정 (필터 초기화 버그)

### 문제
새로고침 시 필터가 초기화되는 버그

### 원인
`FilterSidebar`의 `useEffect`에서 `options`가 아직 로드되지 않은 상태에서 `filters`가 먼저 로드되면:
- `options?.depth_ones.includes(job)` 체크가 항상 false
- 모든 직무가 `depth2s`로 분류되어 잘못된 상태 설정

### 해결

```diff
// jobs/page.tsx - FilterSidebar useEffect
  useEffect(() => {
+   // options가 아직 로드되지 않았으면 대기
+   if (!options) return
+   
    if (filters && filters.preferred_job_types) {
      // ...
    }
  }, [filters, options])
```

### 수정 파일
- [page.tsx](file:///C:/Users/Administrator/Desktop/채용공고/web/app/jobs/page.tsx) (라인 60-87)

---
*Antigravity에서 작성됨 - Claude Desktop에서 이어서 작업 가능*
